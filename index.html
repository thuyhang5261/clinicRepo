<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Phòng Khám Hồng Nhận - Live Stream</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body { background: #f8f9fa; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        .stream-container { background: #000; border-radius: 15px; overflow: hidden; box-shadow: 0 10px 30px rgba(0,0,0,0.3); }
        .stream-header { background: linear-gradient(90deg, #667eea 0%, #764ba2 100%); padding: 15px 20px; color: white; text-align: center; }
        .video-container { position: relative; aspect-ratio: 16/9; background: #000; }
        #streamPlayer { width: 100%; height: 100%; object-fit: cover; }
        .offline-message { position: absolute; top: 0; left: 0; width: 100%; height: 100%; display: flex; flex-direction: column; justify-content: center; align-items: center; background: rgba(0,0,0,0.8); color: white; }
        .status-indicator { position: absolute; top: 15px; left: 15px; background: rgba(0,0,0,0.8); color: white; padding: 8px 15px; border-radius: 25px; font-size: 14px; display: flex; align-items: center; gap: 10px; }
        .control-bar { display: flex; justify-content: center; gap: 10px; padding: 20px; background: #1a1a1a; flex-wrap: wrap; }
        .control-btn { background: #333; color: white; border: none; padding: 12px 20px; border-radius: 10px; cursor: pointer; transition: all 0.3s; font-size: 14px; }
        .control-btn:hover { background: #555; transform: translateY(-2px); }
        .chat-section { background: white; border-radius: 15px; box-shadow: 0 5px 20px rgba(0,0,0,0.1); }
        
        /* Mobile optimizations */
        @media (max-width: 768px) {
            .video-container { aspect-ratio: 16/9; min-height: 200px; }
            .control-bar { padding: 15px; gap: 8px; }
            .control-btn { padding: 10px 15px; font-size: 12px; }
            .stream-header h4 { font-size: 18px; }
            .stream-header small { font-size: 12px; }
            #manual-play-button { padding: 12px 24px !important; font-size: 16px !important; }
        }
        
        /* iOS Safari specific fixes */
        @supports (-webkit-appearance: none) {
            #streamPlayer { -webkit-playsinline: true; }
        }
        .chat-header { background: linear-gradient(90deg, #667eea 0%, #764ba2 100%); color: white; padding: 15px; border-radius: 15px 15px 0 0; }
        .chat-messages { height: 300px; overflow-y: auto; padding: 15px; border-bottom: 1px solid #eee; }
        .chat-input { padding: 15px; }
        .message { margin-bottom: 10px; padding: 8px 12px; border-radius: 10px; background: #f8f9fa; }
        .message.user { background: #007bff; color: white; margin-left: 20%; }
    </style>
</head>
<body>
    <div class="container-fluid py-4">
        <div class="row">
            <!-- Stream Section -->
            <div class="col-xl-8 col-lg-8 col-md-12 mb-4">
                <div class="stream-container">
                    <div class="stream-header">
                        <h4><i class="fas fa-broadcast-tower me-2"></i>Phòng Khám Hồng Nhận - Live Consultation</h4>
                        <small>Professional Medical Consultation Service</small>
                    </div>
                    
                    <div class="video-container">
                        <video id="streamPlayer" 
                               class="img-fluid w-100 h-100" 
                               autoplay 
                               muted 
                               playsinline 
                               preload="none"
                               webkit-playsinline
                               style="object-fit: cover;">
                            Your browser does not support the video tag.
                        </video>

                        <!-- Offline Message -->
                        <div class="offline-message" id="offlineMessage">
                            <h5>Stream Offline</h5>
                            <p>The stream will start automatically when available</p>
                            <div class="spinner-border spinner-border-sm" role="status">
                                <span class="visually-hidden">Loading...</span>
                            </div>
                        </div>

                        <!-- Status Indicator -->
                        <div class="status-indicator" id="statusIndicator">
                            <span id="streamStatus">⏹️ OFFLINE</span>
                            <span id="viewerCount" class="ms-2"><i class="fas fa-eye me-1"></i>0 viewers</span>
                        </div>
                    </div>

                    <!-- Control Bar -->
                    <div class="control-bar">
                        <button class="control-btn" id="refreshBtn"><i class="fa-solid fa-arrows-rotate"></i></button>
                        <button class="control-btn" id="muteBtn"><i class="fa-solid fa-volume-xmark"></i></button>
                        <button class="control-btn" id="settingsBtn"><i class="fas fa-cog"></i></button>
                        <button class="control-btn" id="heartBtn"><img width="14" height="14" src="https://img.icons8.com/color/48/like--v3.png" alt="like--v3" /></button>
                        <button class="control-btn" id="fullscreenBtn"><i class="fas fa-expand"></i></button>
                        <button class="control-btn" id="shareBtn"><i class="fas fa-share"></i> Share</button>
                    </div>
                </div>
            </div>

            <!-- Chat Section -->
            <div class="col-xl-4 col-lg-4 col-md-12">
                <div class="chat-section">
                    <div class="chat-header">
                        <h6><i class="fas fa-comments me-2"></i>Live Chat</h6>
                    </div>
                    <div class="chat-messages" id="chatMessages">
                        <div class="message">
                            <strong>System:</strong> Welcome to the live consultation!
                        </div>
                        <div class="message">
                            <strong>Dr. Thắng:</strong> Hello everyone, ready to start the consultation.
                        </div>
                    </div>
                    <div class="chat-input">
                        <div class="input-group">
                            <input type="text" class="form-control" id="messageInput" placeholder="Type your message...">
                            <button class="btn btn-primary" id="sendBtn">
                                <i class="fas fa-paper-plane"></i>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Stream Info -->
                <div class="card mt-3">
                    <div class="card-body">
                        <h6 class="card-title"><i class="fas fa-info-circle me-2"></i>Stream Information</h6>
                        <p class="card-text"><strong>Doctor:</strong> Dr. Thắng</p>
                        <p class="card-text"><strong>Specialty:</strong> General Medicine</p>
                        <p class="card-text"><strong>Language:</strong> Vietnamese</p>
                        <p class="card-text"><strong>Schedule:</strong> Mon-Fri 8AM-6PM</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <script src="viewer.js"></script>
</body>
</html>
